
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Sizeof与Strlen的区别 | Sweetfish</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Sizeof与Strlen的区别">
<meta property="og:type" content="article">
<meta property="og:title" content="Sizeof与Strlen的区别">
<meta property="og:url" content="http://www.sweetfish1991.com/2014/01/15/Sizeof与Strlen的区别/index.html">
<meta property="og:site_name" content="Sweetfish">
<meta property="og:description" content="Sizeof与Strlen的区别">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Sizeof与Strlen的区别">
<meta name="twitter:description" content="Sizeof与Strlen的区别">
  
    <link rel="alternative" href="/atom.xml" title="Sweetfish" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
</head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Sweetfish</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          小短腿的鱼
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
          <a class="main-nav-link" href="/">Home</a>
        
          
          <a class="main-nav-link" href="/archives">Archives</a>
        
          
            <a class="main-nav-link" href="http://blog.sweetfish1991.com" target="_blank">Fish</a>
          
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="www.sweetfish1991.com">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-Sizeof与Strlen的区别" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/01/15/Sizeof与Strlen的区别/" class="article-date">
  <time datetime="2014-01-15T07:48:05.000Z" itemprop="datePublished">2014-01-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/C-C/">C/C++</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Sizeof与Strlen的区别
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Sizeof与Strlen的区别<br><a id="more"></a></p>
<h1 id="1-_sizeof">1. sizeof</h1><p>　　sizeof(…)是运算符，在头文件中typedef为unsigned int，其值在编译时即计算好了，参数可以是数组、指针、类型、对象、函数等。<br>　　它的功能是：获得保证能容纳实现所建立的最大对象的字节大小。<br>　　由于在编译时计算，因此sizeof不能用来返回动态分配的内存空间的大小。实际上，用sizeof来返回类型以及静态分配的对象、结构或数组所占的空间，返回值跟对象、结构、数组所存储的内容没有关系。<br>　　具体而言，当参数分别如下时，sizeof返回的值表示的含义如下：<br>　　　　数组——编译时分配的数组空间大小；<br>　　　　指针——存储该指针所用的空间大小（存储该指针的地址的长度，是长整型，应该为4）；<br>　　　　类型——该类型所占的空间大小；<br>　　　　对象——对象的实际占用空间大小；<br>　　　　函数——函数的返回类型所占的空间大小。函数的返回类型不能是void。</p>
<hr>
<h1 id="2-_strlen">2. strlen</h1><p>　　strlen(…)是函数，要在运行时才能计算。参数必须是字符型指针（char*）。当数组名作为参数传入时，实际上数组就退化成指针了。<br>　　它的功能是：返回字符串的长度。该字符串可能是自己定义的，也可能是内存中随机的，该函数实际完成的功能是从代表该字符串的第一个地址开始遍历，直到遇到结束符NULL。返回的长度大小不包括NULL。</p>
<hr>
<h1 id="3-_举例：">3. 举例：</h1><h5 id="NO-1">NO.1</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> arr[<span class="number">10</span>] = <span class="string">"What?"</span>;</span><br><span class="line"><span class="keyword">int</span> len_one = <span class="built_in">strlen</span>(arr);</span><br><span class="line"><span class="keyword">int</span> len_two = <span class="keyword">sizeof</span>(arr); </span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; len_one &lt;&lt; <span class="string">" and "</span> &lt;&lt; len_two &lt;&lt; endl;</span><br><span class="line">```	   </span><br><span class="line">输出结果为：<span class="number">5</span> and <span class="number">10</span></span><br><span class="line">&gt;<span class="keyword">sizeof</span>返回定义arr数组时，编译器为其分配的数组空间大小，不关心里面存了多少数据。<span class="built_in">strlen</span>只关心存储的数据内容，不关心空间的大小和类型。</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#####NO.2</span></span><br></pre></td></tr></table></figure>
<p>char <em> parr = new char[10];<br>int len_one = strlen(parr);<br>int len_two = sizeof(parr);<br>int len_three = sizeof(</em>parr);<br>cout &lt;&lt; len_one &lt;&lt; “ and “ &lt;&lt; len_two &lt;&lt; “ and “ &lt;&lt; len_three &lt;&lt; endl;<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">输出结果：<span class="number">23</span> and <span class="number">4</span> and <span class="number">1</span></span><br><span class="line">&gt; 第一个输出结果<span class="number">23</span>实际上每次运行可能不一样，这取决于parr里面存了什么（从parr[<span class="number">0</span>]开始知道遇到第一个NULL结束）；第二个结果实际上本意是想计算parr所指向的动态内存空间的大小，但是事与愿违，<span class="keyword">sizeof</span>认为parr是个字符指针，因此返回的是该指针所占的空间（指针的存储用的是长整型，所以为<span class="number">4</span>）;第三个结果，由于*parr所代表的是parr所指的地址空间存放的字符，所以长度为<span class="number">1</span>。</span><br><span class="line"></span><br><span class="line">***</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#4. 参考资料：</span></span><br><span class="line"><span class="preprocessor">###Sizeof与Strlen的区别与联系[转] </span></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> <span class="keyword">sizeof</span>操作符的结果类型是size_t，它在头文件中typedef为unsigned <span class="keyword">int</span>类型。该类型保证能容纳实现所建立的最大对象的字节大小。 </span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> <span class="keyword">sizeof</span>是算符，strlen是函数。 </span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> <span class="keyword">sizeof</span>可以用类型做参数，strlen只能用<span class="keyword">char</span>*做参数，且必须是以<span class="string">''</span>\<span class="number">0</span><span class="string">''</span>结尾的。 </span><br><span class="line"><span class="keyword">sizeof</span>还可以用函数做参数，比如：</span><br></pre></td></tr></table></figure></p>
<p>short f();<br>printf(“%d\n”, sizeof(f()));<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">输出的结果是<span class="keyword">sizeof</span>(<span class="keyword">short</span>)，即<span class="number">2</span>。 </span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> 数组做<span class="keyword">sizeof</span>的参数不退化，传递给<span class="built_in">strlen</span>就退化为指针了。 </span><br><span class="line"></span><br><span class="line"><span class="number">5.</span> 大部分编译程序 在编译的时候就把<span class="keyword">sizeof</span>计算过了 是类型或是变量的长度这就是<span class="keyword">sizeof</span>(x)可以用来定义数组维数的原因</span><br></pre></td></tr></table></figure></p>
<p>char str[20]=”0123456789”;<br>int a=strlen(str); //a=10;<br>int b=sizeof(str); //而b=20;<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">6.</span> <span class="built_in">strlen</span>的结果要在运行的时候才能计算出来，时用来计算字符串的长度，不是类型占内存的大小。 </span><br><span class="line"></span><br><span class="line"><span class="number">7.</span> <span class="keyword">sizeof</span>后如果是类型必须加括弧，如果是变量名可以不加括弧。这是因为<span class="keyword">sizeof</span>是个操作符不是个函数。 </span><br><span class="line"></span><br><span class="line"><span class="number">8.</span> 当适用了于一个结构类型时或变量， <span class="keyword">sizeof</span> 返回实际的大小， </span><br><span class="line">当适用一静态地空间数组， <span class="keyword">sizeof</span> 归还全部数组的尺寸。 </span><br><span class="line"><span class="keyword">sizeof</span> 操作符不能返回动态地被分派了的数组或外部的数组的尺寸 </span><br><span class="line"></span><br><span class="line"><span class="number">9.</span> 数组作为参数传给函数时传的是指针而不是数组，传递的是数组的首地址，如：</span><br></pre></td></tr></table></figure></p>
<p>fun(char [8])<br>fun(char [])<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">都等价于 <span class="function"><span class="title">fun</span><span class="params">(char *)</span></span> </span><br><span class="line">在C++里参数传递数组永远都是传递指向数组首元素的指针，编译器不知道数组的大小 </span><br><span class="line">如果想在函数内知道数组的大小， 需要这样做：进入函数后用memcpy拷贝出来，长度由另一个形参传进去</span><br></pre></td></tr></table></figure></p>
<p>fun(unsiged char <em>p1, int len)<br>{<br>        unsigned char</em> buf = new unsigned char[len+1];<br>        memcpy(buf, p1, len);<br>}<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">看了上面的详细解释，发现两者使用的区别，从这个例子可以看得很清楚：</span><br></pre></td></tr></table></figure></p>
<p>char str[20]=”0123456789”;<br>int a=strlen(str); //a=10; &gt;&gt;&gt;&gt; strlen 计算字符串的长度，以结束符 0x00 为字符串结束。<br>int b=sizeof(str); //而b=20; &gt;&gt;&gt;&gt; sizeof 计算的则是分配的数组 str[20] 所占的内存空间的大小，不受里面存储的内容改变。<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">上面是对静态数组处理的结果，如果是对指针，结果就不一样了：</span><br></pre></td></tr></table></figure></p>
<p>char<em> ss = “0123456789”;<br>sizeof(ss)  //结果 4 &gt;&gt;&gt;&gt;ss是指向字符串常量的字符指针，sizeof 获得的是一个指针的之所占的空间,应该是长整型的，所以是4<br>sizeof(</em>ss)  //结果 1 &gt;&gt;&gt;&gt;*ss是第一个字符 其实就是获得了字符串的第一位’0’ 所占的内存空间，是char类型的，占了 1 位<br>strlen(ss)   //结果10 &gt;&gt;&gt;&gt; 如果要获得这个字符串的长度，则一定要使用 strlen<br>```</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://www.sweetfish1991.com/2014/01/15/Sizeof与Strlen的区别/" data-id="ci7kcehve000xfsuqm4pg2ocy" class="article-share-link" data-share="baidu">分享到</a>
      

      
        <a href="http://www.sweetfish1991.com/2014/01/15/Sizeof与Strlen的区别/#ds-thread" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C-C/">C/C++</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/01/16/数组指针和指针数组/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">
        
          数组指针和指针数组
        
      </div>
    </a>
  
  
</nav>

  
</article>


  <section id="comments">
    <div id="ds-thread" class="ds-thread" data-thread-key="2014/01/15/Sizeof与Strlen的区别/" data-title="Sizeof与Strlen的区别" data-url="http://www.sweetfish1991.com/2014/01/15/Sizeof与Strlen的区别/"></div>
  </section>
</section>
      
      <aside id="sidebar">
  
    <div class="photoIntroduce">
  <br>
	<center><img class="img_logo" src="\img\logo.png" heigh=150 width=150></center>
	<center>敲键盘&nbsp按快门&nbsp玩PS&nbsp的厨子</center>
	<center>
	<a href="http://blog.sweetfish1991.com" target="_blank" title="非昔"><i class="fa fa-heart fa-lg"></i></a>&nbsp
	<a href="http://weibo.com/arical1991" target="_blank" title="微博"><i class="fa fa-weibo fa-lg"></i></a>&nbsp
	<a href="https://github.com/sweetfish" target="_blank" title="GitHub"><i class="fa fa-github fa-lg"></i></a>&nbsp
	<a href="http://www.sweetfish1991.com" target="_blank" title="微信"><i class="fa fa-weixin fa-lg"></i></a>
	
	</center>
  </br>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/C-C/">C/C++</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/">读书笔记</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/高质量程序设计指南-读书笔记/">高质量程序设计指南-读书笔记</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/C-C/" style="font-size: 20px;">C/C++</a><a href="/tags/C-C-读书笔记/" style="font-size: 10px;">C/C++ 读书笔记</a><a href="/tags/读书笔记/" style="font-size: 15px;">读书笔记</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">十一月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/01/">一月 2014</a><span class="archive-list-count">6</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/03/17/第八章/">第八章</a>
          </li>
        
          <li>
            <a href="/2015/03/16/字符数组和字符串/">字符数组和字符串</a>
          </li>
        
          <li>
            <a href="/2015/03/16/指针与引用互换/">指针与引用互换</a>
          </li>
        
          <li>
            <a href="/2015/03/16/指向数组指针的下标/">指向数组指针的下标</a>
          </li>
        
          <li>
            <a href="/2015/03/16/指向const的对象的指针和const指针/">指向const的对象的指针和const指针</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://blog.sweetfish1991.com" target="_blank">非昔</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 Sweetfish<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->

<!-- 多说公共js代码 start -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"sweetfish"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- 多说公共js代码 end -->


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>window._bd_share_config={"common":{},"share":{"bdCustomStyle":"/css/bdshare.css"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>




<script src="/js/script.js" type="text/javascript"></script>

</div>
</body>
</html>
